UML weblarek - `https://app.creately.com/d/wuI36UfhiGi/edit`

# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами


https://github.com/RomanGRS/web-larek-frontend.git

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Подход разработки
В проекте используется событийно-ориентированный подход. Взаимодействие между различными компонентами приложения осуществляется через обмен сообщениями, вызванными событиями. 

В проекте используется модель MVP (Model-View-Presenter), которая разделяет приложение на три основных компонента: модель, отображение и презентёр. Модель отвечает за работу с данными и бизнес-логикой, отображение представляет собой интерфейс пользователя, а презентёр связывает модель данных и отображение, обрабатывая события и передавая данные между ними. 

## Базовый код
### Класс `Model`
Абстрактный класс дженерик, обощающий в себе конструктор и метод привязки события. 
Класс является дженериком и принимает в переменной `<T>` тип данных модели. 
Конструктор, принимая на вход объект данных и объект события типа IEvent, объединяет входящий объект с родительским

Метод 
`emmitChanges` выдает сообщение об изменении данных — регистрирует входящее событие в `EventEmitter`

### Класс `Component`
Абстрактный класс дженерик, содержащий общий конструктор и методы работы с компонентами отображения. 
Класс является дженериком и принимает в переменной `<T>` тип данных компонента отображения. 
Конструктор принимает на вход `container` типа `HTMLElement`.
Методы:
`toggleClass` — метод переключения класса элемента
`setDisabled` — метод блокировки кнопки
`setText` — метод установки текста элемента
`setImage` — метод установки изображения элемента и его alt
`render` — метод слияния входящих данных и отрисовки элемента

### Класс `EventEmitter`
Класс EventEmitter - брокер событий, implements от IEvents.
Класс EventEmitter обеспечивает работу событий. Устанавливает и снимает слушателей событий, вызвает слушателей при возникновении события.

Методы:
`on` - для подписки на событие.
`off` - для отписки от события.
`emit` - уведомления подписчиков о наступлении события соответственно.
`onAll` - для подписки на все события.
`offAll` - сброса всех подписчиков.
`trigger` - генерирует заданное событие с заданными аргументами. Это позволяет передавать его в качестве обработчика события в другие классы. Эти классы будут генерировать события, не будучи при этом напрямую зависимыми от класса `EventEmitter`.

### Класс `Api`
Хранит основные поля и методы, необходимые при работе с сервером.
Получает и хранит базовый url (baseUrl) и опции запроса (options).
Методы позволяют обработать запрос, отправить и получить данные.

Методы:
`handleResponse(response: Response): Promise<object>` - обработчик ответа сервера.
`get(url: string)` - принимает изменяющеюся часть url-адреса, возвращает ответ от сервера.
`post(url: string, data: object, method: ApiPostMethods = 'POST')` - принимает изменяющеюся часть url-адреса, принимает данные в виде объекта для отправки на сервер, type ApiPostMethods = 'POST' | 'PUT' | 'DELETE'.

## Компоненты модели данных (Model)
### Класс `ShopApi`
Основной класс работы с сервером в проекте. Расширяется базовым классом `Api `.
Конструктор:
принимает и передает в родительский конструктор `Api` поля `baseUrl` и `options`;
принимает и сохраняет входящий url запроса в cdn.
Поле `cdn` — хранит входящий url
Методы:
`getProductList` — метод получения списка товаров с сервера
`orderProducts` — метод отправки данных заказа на сервер

### Класс `AppState`
Является моделью данных приложения. Данный класс содержит в себе все основные данные страницы и методы работы с этими данными. 
Тут распределяются данные по частям приложения: каталог, превью, корзина, форма заказа. 

Поля
`catalog` — для данных списка товаров пришедших с сервера
`preview` — для данных товара открытого в превью
`basket` — для данных товаров добавленных в корзину
`order` — для данных заказа, который отправляется на сервер
`formErrors` — для ошибок валидации

Методы
`clearBasket` — очистка данных корзины
`addToOrder` — добавить товар в заказ
`removeFromOrder` — удалить товар из заказа
`setCatalog` — установить данные в каталог
`setPreview` — установить данные в превью
`setProductToBasket` — установить данные в корзину
`removeProductToBasket` — удалить данные товара из корзины
`getStatusBasket` — получить статус корзины
`getBskt` — получить данные товаров в корзине
`setTotal` — установить сумму товаров в корзине
`getTotal` — получить сумму товаров в корзине
`setOrderField` — установить поле заказа
`setContactsField` — установить поле контактов
`validateOrder` — провести валидацию данных заказа
`validateContacts` — провести валидацию данных контактов
Расширяется базовым абстрактным классом `Model` по интерфейсу `IAppState`. 
``` type/index.ts ```

### Класс `Product`
Модель хранящая данные товара полученные с сервера(индефикатор, описание, изображение, название, категорию, цену).
Методов нет.
Расширяется базовым абстрактным классом `Model<T>` по интерфейсу `IProductItem`.
``` type/index.ts ```


## Компоненты представления (View)
### Класс `Card`
Отвечает за отображение данных карточки товара. 
Поля отвечают за связь с разметкой, методы за наполнение разметки данными. 

Поля
`_title` — хранит разметку заголовка карточки
`_category` — хранит разметку категории карточки
`_image` — хранит разметку изображения карточки
`_price` — хранит разметку цены карточки
`_categoryColor` — является словарем для дальнейшей модификации класса категории в зависимости от ее содержимого

Методы
`setTitle` — установка содержимого заголовка
`setCategory` — установка содержимого категории
`setImage` — установка содержимого изображения
`setPrice` — установка содержимого цены

Расширяется базовым абстрактным классом `Component<T>` по интерфейсу  `ICard`
```tsx
interface ICard {
  title: string;
  image: string;
  description: string;
  button: string;
  category: string;
  price: string;
}
```

### Класс `Page`
Отвечает за отображение страницы и ее основных элементов. 
Поля отвечают за связь с разметкой, методы за наполнение разметки данными, закрытие/открытие для листинга страницы при открытии/закрытии модального окна. 

Поля
`_counter` — хранит разметку счетчика товаров в корзине
`_catalog` — хранит разметку каталога товаров
`_wrapper` — хранит разметку обертки страницы
`_basket` — хранит разметке кнопки корзины

Методы
`setCounter` — устанавливает счетчик товаров корзины
`setCatalog` — устанавливает каталог
`setLocked` — устанавливает класс, препятствующий прокрутке страницы

Расширяется базовым абстрактным классом `Component<T>` по интерфейсу  `IPage`
```tsx
interface IPage {
  counter: number;
  catalog: HTMLElement[];
  locked: boolean;
}
```

### Класс `Modal`
Отвечает за отображение модального окна. 
Имеет поля и методы, которые связаны с закрытием и открытием окна, а также наполнение его нужным контентом. 

Поля
`_closeButton` — разметка кнопки закрытия модального окна
`_content` — разметка контейнера для содержимого модального окна

Методы
`setContent` — установить контент модального окна
`open` — открыть модальное окно
`close` — закрыть модальное окно
`render` — отобразить данные контента и открыть модальное окно

Расширяется базовым абстрактным классом `Component<T>` по интерфейсу  `IModalData`
```tsx
interface IModalData {
    content: HTMLElement;
}
```

### Класс `Order`
Отвечает за отображение заказа в модальном окне. 

Поля
`_buttons` — хранит разметку кнопок формы оплаты

Методы
`setPayment` — устанавливает класс активности на кнопку
`setAddress` — устанавливает значение поля адресa

Расширяется базовым абстрактным классом `Component<T>` по интерфейсу  `IOrderForm`
``` type/index.ts ```

### Класс `Form`
Отвечает за отображение формы и ее валидацию.
Класс является дженериком и принимает в переменной `<T>` тип данных компонента отображения. 

Поля
`_submit` — содержит разметку кнопки отправки формы
`_errors` — содержит разметку вывода ошибок валидации

Методы
`onInputChange` — регистрирует событие с именем конкретного поля
`setValid` — метод установки валидности
`setErrors` — метод установки ошибки
`render` — отображение формы и ее элементов

Расширяется базовым абстрактным классом `Component<T>` по интерфейсу  `IFormState`
```tsx
interface IFormState {
    valid: boolean;
    errors: string[];
}
```

### Класс `Success`
Отвечает за отображение успешного оформления заказа в модальном окне.

Поля
`_total` — разметка общей суммы товаров в заказе
`_close` — разметка кнопки закрытия окна

Методы
`setTotal` — установка значения общей суммы

Расширяется базовым абстрактным классом `Component<T>` по интерфейсу  `ISuccess`
```tsx
interface ISuccess {
    total: number;
}
```

### Класс `Basket`
Отвечает за отображение корзины в модальном окне. Удаляет позицию товара из корзины. 

Поля
`_list` — содержит разметку списка товаров
`_total` — содержит разметку для суммы товаров
`button` — содержит разметку кнопки для оформления заказа
`items` — содержит список товаров в корзине

Методы
`setItems` — устанавливает товары в разметку _list
`setTotal` — устанавливает значение суммы товаров

Расширяется базовым абстрактным классом `Component<T>` по интерфейсу  `IBasket`
```tsx
interface IBasket {
    items: HTMLElement[];
    total: number;
}
